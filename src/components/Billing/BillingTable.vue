<template>
  <v-row>
    <SnackBar :data="snackbar" ref="snackbar"></SnackBar>
    <v-dialog
      v-model="editModal"
      width="500"
    >
      <v-card>
        <v-card-title class="text-h5 lighten-2">
          {{ translate("Commission") }}
        </v-card-title>

        <v-card-text>
          <v-text-field
            :label="translate('Commission')"
            v-model="commission_value"
          ></v-text-field>
        </v-card-text>

        <v-divider></v-divider>

        <v-card-actions>
          <v-spacer></v-spacer>
          <v-btn
            text
            @click="editModal = false"
          >
            {{ translate('Close') }}
          </v-btn>
          <v-btn
            color="primary"
            @click="updateCommission"
          >
           {{ translate('Finish') }} 
          </v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>

    <!-- <v-col cols="12" xs="12" sm="12" md="3" lg="3" v-if="isAdmin">
      <v-card outlined rounded class="user-card">
        <v-card-title class="text-h6">{{translate('All Leads')}}</v-card-title>
        <div class="d-flex justify-center pa-6">
          <svg
            width="275"
            height="121"
            viewBox="0 0 275 121"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M114.249 7.64021C121.033 13.5077 126.43 20.7948 130.053 28.9801C133.676 37.1654 135.437 46.0466 135.208 54.9883L76.3561 53.5062C75.5095 53.4849 75.0713 52.4867 75.6285 51.8488L114.249 7.64021Z"
              fill="#FE9210"
            />
            <path
              d="M104.337 44.022V45H99.6273V44.022H101.427V38.61C101.427 38.418 101.433 38.222 101.445 38.022L100.059 39.192C99.9993 39.24 99.9373 39.272 99.8733 39.288C99.8133 39.3 99.7553 39.3 99.6993 39.288C99.6473 39.276 99.5993 39.258 99.5553 39.234C99.5153 39.206 99.4833 39.176 99.4593 39.144L99.0573 38.58L101.661 36.342H102.711V44.022H104.337ZM109.462 41.808V38.652C109.462 38.4 109.48 38.124 109.516 37.824L106.612 41.808H109.462ZM111.778 41.808V42.552C111.778 42.624 111.754 42.686 111.706 42.738C111.662 42.79 111.594 42.816 111.502 42.816H110.584V45H109.462V42.816H105.724C105.632 42.816 105.552 42.79 105.484 42.738C105.42 42.682 105.378 42.614 105.358 42.534L105.226 41.874L109.372 36.354H110.584V41.808H111.778ZM116.501 38.448C116.501 38.78 116.447 39.078 116.339 39.342C116.235 39.606 116.093 39.832 115.913 40.02C115.733 40.204 115.525 40.346 115.289 40.446C115.053 40.542 114.805 40.59 114.545 40.59C114.265 40.59 114.005 40.542 113.765 40.446C113.529 40.346 113.323 40.204 113.147 40.02C112.975 39.832 112.839 39.606 112.739 39.342C112.639 39.078 112.589 38.78 112.589 38.448C112.589 38.108 112.639 37.804 112.739 37.536C112.839 37.264 112.975 37.036 113.147 36.852C113.323 36.664 113.529 36.52 113.765 36.42C114.005 36.32 114.265 36.27 114.545 36.27C114.825 36.27 115.083 36.32 115.319 36.42C115.559 36.52 115.765 36.664 115.937 36.852C116.113 37.036 116.251 37.264 116.351 37.536C116.451 37.804 116.501 38.108 116.501 38.448ZM115.505 38.448C115.505 38.204 115.479 37.998 115.427 37.83C115.379 37.658 115.311 37.52 115.223 37.416C115.139 37.308 115.037 37.232 114.917 37.188C114.801 37.14 114.677 37.116 114.545 37.116C114.409 37.116 114.283 37.14 114.167 37.188C114.051 37.232 113.951 37.308 113.867 37.416C113.783 37.52 113.717 37.658 113.669 37.83C113.621 37.998 113.597 38.204 113.597 38.448C113.597 38.688 113.621 38.89 113.669 39.054C113.717 39.218 113.783 39.352 113.867 39.456C113.951 39.556 114.051 39.628 114.167 39.672C114.283 39.716 114.409 39.738 114.545 39.738C114.677 39.738 114.801 39.716 114.917 39.672C115.037 39.628 115.139 39.556 115.223 39.456C115.311 39.352 115.379 39.218 115.427 39.054C115.479 38.89 115.505 38.688 115.505 38.448ZM119.465 36.57C119.509 36.514 119.561 36.466 119.621 36.426C119.685 36.382 119.773 36.36 119.885 36.36H120.815L114.449 44.802C114.405 44.858 114.351 44.906 114.287 44.946C114.223 44.982 114.145 45 114.053 45H113.093L119.465 36.57ZM121.337 42.966C121.337 43.298 121.283 43.596 121.175 43.86C121.067 44.124 120.923 44.348 120.743 44.532C120.563 44.716 120.355 44.858 120.119 44.958C119.883 45.054 119.635 45.102 119.375 45.102C119.095 45.102 118.835 45.054 118.595 44.958C118.359 44.858 118.153 44.716 117.977 44.532C117.805 44.348 117.669 44.124 117.569 43.86C117.473 43.596 117.425 43.298 117.425 42.966C117.425 42.626 117.473 42.322 117.569 42.054C117.669 41.782 117.805 41.552 117.977 41.364C118.153 41.176 118.359 41.034 118.595 40.938C118.835 40.838 119.095 40.788 119.375 40.788C119.655 40.788 119.915 40.838 120.155 40.938C120.395 41.034 120.601 41.176 120.773 41.364C120.949 41.552 121.087 41.782 121.187 42.054C121.287 42.322 121.337 42.626 121.337 42.966ZM120.341 42.966C120.341 42.722 120.315 42.516 120.263 42.348C120.215 42.176 120.147 42.038 120.059 41.934C119.971 41.826 119.867 41.75 119.747 41.706C119.631 41.658 119.507 41.634 119.375 41.634C119.243 41.634 119.119 41.658 119.003 41.706C118.887 41.75 118.785 41.826 118.697 41.934C118.613 42.038 118.547 42.176 118.499 42.348C118.451 42.516 118.427 42.722 118.427 42.966C118.427 43.206 118.451 43.408 118.499 43.572C118.547 43.736 118.613 43.87 118.697 43.974C118.785 44.074 118.887 44.146 119.003 44.19C119.119 44.234 119.243 44.256 119.375 44.256C119.507 44.256 119.631 44.234 119.747 44.19C119.867 44.146 119.971 44.074 120.059 43.974C120.147 43.87 120.215 43.736 120.263 43.572C120.315 43.408 120.341 43.206 120.341 42.966Z"
              fill="white"
            />
            <rect x="155" y="16" width="16" height="16" rx="5" fill="#FE9210" />
            <path
              d="M186.018 27.824V29H181.026V20.36H182.43V27.824H186.018ZM189.256 22.784C189.708 22.784 190.116 22.858 190.48 23.006C190.848 23.154 191.16 23.364 191.416 23.636C191.676 23.908 191.876 24.238 192.016 24.626C192.156 25.014 192.226 25.45 192.226 25.934C192.226 26.418 192.156 26.854 192.016 27.242C191.876 27.63 191.676 27.962 191.416 28.238C191.16 28.51 190.848 28.72 190.48 28.868C190.116 29.016 189.708 29.09 189.256 29.09C188.8 29.09 188.388 29.016 188.02 28.868C187.656 28.72 187.344 28.51 187.084 28.238C186.824 27.962 186.624 27.63 186.484 27.242C186.344 26.854 186.274 26.418 186.274 25.934C186.274 25.45 186.344 25.014 186.484 24.626C186.624 24.238 186.824 23.908 187.084 23.636C187.344 23.364 187.656 23.154 188.02 23.006C188.388 22.858 188.8 22.784 189.256 22.784ZM189.256 28.082C189.808 28.082 190.218 27.898 190.486 27.53C190.758 27.158 190.894 26.628 190.894 25.94C190.894 25.252 190.758 24.722 190.486 24.35C190.218 23.974 189.808 23.786 189.256 23.786C188.696 23.786 188.28 23.974 188.008 24.35C187.736 24.722 187.6 25.252 187.6 25.94C187.6 26.628 187.736 27.158 188.008 27.53C188.28 27.898 188.696 28.082 189.256 28.082ZM194.684 24.014C194.876 23.626 195.108 23.322 195.38 23.102C195.652 22.878 195.978 22.766 196.358 22.766C196.49 22.766 196.614 22.782 196.73 22.814C196.846 22.842 196.95 22.886 197.042 22.946L196.952 23.918C196.936 23.986 196.91 24.034 196.874 24.062C196.842 24.086 196.798 24.098 196.742 24.098C196.682 24.098 196.596 24.088 196.484 24.068C196.372 24.044 196.254 24.032 196.13 24.032C195.95 24.032 195.79 24.058 195.65 24.11C195.514 24.162 195.39 24.238 195.278 24.338C195.17 24.438 195.074 24.56 194.99 24.704C194.906 24.848 194.828 25.012 194.756 25.196V29H193.466V22.88H194.216C194.352 22.88 194.446 22.906 194.498 22.958C194.55 23.006 194.586 23.092 194.606 23.216L194.684 24.014ZM201.698 25.25C201.698 25.034 201.666 24.834 201.602 24.65C201.542 24.462 201.452 24.3 201.332 24.164C201.212 24.024 201.062 23.916 200.882 23.84C200.706 23.76 200.502 23.72 200.27 23.72C199.802 23.72 199.434 23.854 199.166 24.122C198.898 24.39 198.728 24.766 198.656 25.25H201.698ZM198.62 26.042C198.636 26.39 198.69 26.692 198.782 26.948C198.874 27.2 198.996 27.41 199.148 27.578C199.304 27.746 199.488 27.872 199.7 27.956C199.916 28.036 200.156 28.076 200.42 28.076C200.672 28.076 200.89 28.048 201.074 27.992C201.258 27.932 201.418 27.868 201.554 27.8C201.69 27.728 201.806 27.664 201.902 27.608C201.998 27.548 202.086 27.518 202.166 27.518C202.27 27.518 202.35 27.558 202.406 27.638L202.772 28.112C202.62 28.292 202.448 28.444 202.256 28.568C202.064 28.692 201.86 28.794 201.644 28.874C201.428 28.95 201.206 29.004 200.978 29.036C200.75 29.072 200.528 29.09 200.312 29.09C199.888 29.09 199.494 29.02 199.13 28.88C198.77 28.736 198.456 28.526 198.188 28.25C197.924 27.974 197.716 27.632 197.564 27.224C197.416 26.816 197.342 26.346 197.342 25.814C197.342 25.39 197.408 24.994 197.54 24.626C197.676 24.258 197.868 23.938 198.116 23.666C198.368 23.394 198.672 23.18 199.028 23.024C199.388 22.864 199.794 22.784 200.246 22.784C200.622 22.784 200.97 22.846 201.29 22.97C201.61 23.09 201.886 23.268 202.118 23.504C202.35 23.74 202.53 24.03 202.658 24.374C202.79 24.714 202.856 25.102 202.856 25.538C202.856 25.738 202.834 25.872 202.79 25.94C202.746 26.008 202.666 26.042 202.55 26.042H198.62ZM204.059 29V22.88H204.839C205.015 22.88 205.127 22.962 205.175 23.126L205.259 23.66C205.371 23.532 205.487 23.416 205.607 23.312C205.727 23.204 205.855 23.112 205.991 23.036C206.131 22.956 206.279 22.894 206.435 22.85C206.595 22.806 206.767 22.784 206.951 22.784C207.147 22.784 207.327 22.812 207.491 22.868C207.655 22.924 207.799 23.004 207.923 23.108C208.051 23.212 208.161 23.338 208.253 23.486C208.345 23.634 208.421 23.8 208.481 23.984C208.573 23.772 208.689 23.59 208.829 23.438C208.969 23.286 209.125 23.162 209.297 23.066C209.469 22.97 209.651 22.9 209.843 22.856C210.039 22.808 210.237 22.784 210.437 22.784C210.765 22.784 211.057 22.836 211.313 22.94C211.573 23.044 211.791 23.196 211.967 23.396C212.147 23.592 212.283 23.834 212.375 24.122C212.467 24.41 212.513 24.738 212.513 25.106V29H211.223V25.106C211.223 24.674 211.129 24.35 210.941 24.134C210.757 23.914 210.483 23.804 210.119 23.804C209.955 23.804 209.801 23.832 209.657 23.888C209.513 23.944 209.387 24.026 209.279 24.134C209.171 24.242 209.085 24.378 209.021 24.542C208.961 24.702 208.931 24.89 208.931 25.106V29H207.641V25.106C207.641 24.658 207.551 24.33 207.371 24.122C207.191 23.91 206.927 23.804 206.579 23.804C206.339 23.804 206.117 23.866 205.913 23.99C205.709 24.11 205.521 24.276 205.349 24.488V29H204.059Z"
              fill="#4F4F4F"
            />
            <rect x="155" y="43" width="16" height="16" rx="5" fill="#36A5DD" />
            <path
              d="M186.018 54.824V56H181.026V47.36H182.43V54.824H186.018ZM189.256 49.784C189.708 49.784 190.116 49.858 190.48 50.006C190.848 50.154 191.16 50.364 191.416 50.636C191.676 50.908 191.876 51.238 192.016 51.626C192.156 52.014 192.226 52.45 192.226 52.934C192.226 53.418 192.156 53.854 192.016 54.242C191.876 54.63 191.676 54.962 191.416 55.238C191.16 55.51 190.848 55.72 190.48 55.868C190.116 56.016 189.708 56.09 189.256 56.09C188.8 56.09 188.388 56.016 188.02 55.868C187.656 55.72 187.344 55.51 187.084 55.238C186.824 54.962 186.624 54.63 186.484 54.242C186.344 53.854 186.274 53.418 186.274 52.934C186.274 52.45 186.344 52.014 186.484 51.626C186.624 51.238 186.824 50.908 187.084 50.636C187.344 50.364 187.656 50.154 188.02 50.006C188.388 49.858 188.8 49.784 189.256 49.784ZM189.256 55.082C189.808 55.082 190.218 54.898 190.486 54.53C190.758 54.158 190.894 53.628 190.894 52.94C190.894 52.252 190.758 51.722 190.486 51.35C190.218 50.974 189.808 50.786 189.256 50.786C188.696 50.786 188.28 50.974 188.008 51.35C187.736 51.722 187.6 52.252 187.6 52.94C187.6 53.628 187.736 54.158 188.008 54.53C188.28 54.898 188.696 55.082 189.256 55.082ZM194.684 51.014C194.876 50.626 195.108 50.322 195.38 50.102C195.652 49.878 195.978 49.766 196.358 49.766C196.49 49.766 196.614 49.782 196.73 49.814C196.846 49.842 196.95 49.886 197.042 49.946L196.952 50.918C196.936 50.986 196.91 51.034 196.874 51.062C196.842 51.086 196.798 51.098 196.742 51.098C196.682 51.098 196.596 51.088 196.484 51.068C196.372 51.044 196.254 51.032 196.13 51.032C195.95 51.032 195.79 51.058 195.65 51.11C195.514 51.162 195.39 51.238 195.278 51.338C195.17 51.438 195.074 51.56 194.99 51.704C194.906 51.848 194.828 52.012 194.756 52.196V56H193.466V49.88H194.216C194.352 49.88 194.446 49.906 194.498 49.958C194.55 50.006 194.586 50.092 194.606 50.216L194.684 51.014ZM201.698 52.25C201.698 52.034 201.666 51.834 201.602 51.65C201.542 51.462 201.452 51.3 201.332 51.164C201.212 51.024 201.062 50.916 200.882 50.84C200.706 50.76 200.502 50.72 200.27 50.72C199.802 50.72 199.434 50.854 199.166 51.122C198.898 51.39 198.728 51.766 198.656 52.25H201.698ZM198.62 53.042C198.636 53.39 198.69 53.692 198.782 53.948C198.874 54.2 198.996 54.41 199.148 54.578C199.304 54.746 199.488 54.872 199.7 54.956C199.916 55.036 200.156 55.076 200.42 55.076C200.672 55.076 200.89 55.048 201.074 54.992C201.258 54.932 201.418 54.868 201.554 54.8C201.69 54.728 201.806 54.664 201.902 54.608C201.998 54.548 202.086 54.518 202.166 54.518C202.27 54.518 202.35 54.558 202.406 54.638L202.772 55.112C202.62 55.292 202.448 55.444 202.256 55.568C202.064 55.692 201.86 55.794 201.644 55.874C201.428 55.95 201.206 56.004 200.978 56.036C200.75 56.072 200.528 56.09 200.312 56.09C199.888 56.09 199.494 56.02 199.13 55.88C198.77 55.736 198.456 55.526 198.188 55.25C197.924 54.974 197.716 54.632 197.564 54.224C197.416 53.816 197.342 53.346 197.342 52.814C197.342 52.39 197.408 51.994 197.54 51.626C197.676 51.258 197.868 50.938 198.116 50.666C198.368 50.394 198.672 50.18 199.028 50.024C199.388 49.864 199.794 49.784 200.246 49.784C200.622 49.784 200.97 49.846 201.29 49.97C201.61 50.09 201.886 50.268 202.118 50.504C202.35 50.74 202.53 51.03 202.658 51.374C202.79 51.714 202.856 52.102 202.856 52.538C202.856 52.738 202.834 52.872 202.79 52.94C202.746 53.008 202.666 53.042 202.55 53.042H198.62ZM204.059 56V49.88H204.839C205.015 49.88 205.127 49.962 205.175 50.126L205.259 50.66C205.371 50.532 205.487 50.416 205.607 50.312C205.727 50.204 205.855 50.112 205.991 50.036C206.131 49.956 206.279 49.894 206.435 49.85C206.595 49.806 206.767 49.784 206.951 49.784C207.147 49.784 207.327 49.812 207.491 49.868C207.655 49.924 207.799 50.004 207.923 50.108C208.051 50.212 208.161 50.338 208.253 50.486C208.345 50.634 208.421 50.8 208.481 50.984C208.573 50.772 208.689 50.59 208.829 50.438C208.969 50.286 209.125 50.162 209.297 50.066C209.469 49.97 209.651 49.9 209.843 49.856C210.039 49.808 210.237 49.784 210.437 49.784C210.765 49.784 211.057 49.836 211.313 49.94C211.573 50.044 211.791 50.196 211.967 50.396C212.147 50.592 212.283 50.834 212.375 51.122C212.467 51.41 212.513 51.738 212.513 52.106V56H211.223V52.106C211.223 51.674 211.129 51.35 210.941 51.134C210.757 50.914 210.483 50.804 210.119 50.804C209.955 50.804 209.801 50.832 209.657 50.888C209.513 50.944 209.387 51.026 209.279 51.134C209.171 51.242 209.085 51.378 209.021 51.542C208.961 51.702 208.931 51.89 208.931 52.106V56H207.641V52.106C207.641 51.658 207.551 51.33 207.371 51.122C207.191 50.91 206.927 50.804 206.579 50.804C206.339 50.804 206.117 50.866 205.913 50.99C205.709 51.11 205.521 51.276 205.349 51.488V56H204.059ZM218.353 49.88V56H217.063V49.88H218.353ZM218.569 48.032C218.569 48.148 218.545 48.258 218.497 48.362C218.453 48.466 218.391 48.558 218.311 48.638C218.231 48.714 218.137 48.776 218.029 48.824C217.925 48.868 217.813 48.89 217.693 48.89C217.577 48.89 217.467 48.868 217.363 48.824C217.263 48.776 217.175 48.714 217.099 48.638C217.023 48.558 216.961 48.466 216.913 48.362C216.869 48.258 216.847 48.148 216.847 48.032C216.847 47.912 216.869 47.8 216.913 47.696C216.961 47.592 217.023 47.502 217.099 47.426C217.175 47.346 217.263 47.284 217.363 47.24C217.467 47.192 217.577 47.168 217.693 47.168C217.813 47.168 217.925 47.192 218.029 47.24C218.137 47.284 218.231 47.346 218.311 47.426C218.391 47.502 218.453 47.592 218.497 47.696C218.545 47.8 218.569 47.912 218.569 48.032ZM221.264 54.464C221.444 54.696 221.64 54.86 221.852 54.956C222.068 55.048 222.306 55.094 222.566 55.094C223.07 55.094 223.462 54.91 223.742 54.542C224.026 54.174 224.168 53.626 224.168 52.898C224.168 52.522 224.136 52.202 224.072 51.938C224.008 51.67 223.916 51.452 223.796 51.284C223.676 51.116 223.53 50.994 223.358 50.918C223.186 50.842 222.992 50.804 222.776 50.804C222.448 50.804 222.164 50.876 221.924 51.02C221.688 51.16 221.468 51.362 221.264 51.626V54.464ZM221.198 50.768C221.454 50.468 221.744 50.226 222.068 50.042C222.396 49.858 222.776 49.766 223.208 49.766C223.552 49.766 223.864 49.836 224.144 49.976C224.424 50.112 224.664 50.312 224.864 50.576C225.064 50.84 225.218 51.168 225.326 51.56C225.438 51.948 225.493 52.394 225.493 52.898C225.493 53.35 225.432 53.772 225.308 54.164C225.188 54.552 225.014 54.89 224.786 55.178C224.558 55.462 224.282 55.686 223.958 55.85C223.634 56.01 223.268 56.09 222.86 56.09C222.5 56.09 222.194 56.032 221.942 55.916C221.694 55.8 221.468 55.64 221.264 55.436V58.034H219.974V49.88H220.754C220.93 49.88 221.042 49.962 221.09 50.126L221.198 50.768ZM230.401 50.99C230.369 51.046 230.333 51.086 230.293 51.11C230.253 51.134 230.203 51.146 230.143 51.146C230.075 51.146 230.001 51.126 229.921 51.086C229.841 51.042 229.747 50.994 229.639 50.942C229.531 50.89 229.403 50.844 229.255 50.804C229.111 50.76 228.941 50.738 228.745 50.738C228.585 50.738 228.439 50.758 228.307 50.798C228.179 50.834 228.069 50.888 227.977 50.96C227.889 51.028 227.821 51.11 227.773 51.206C227.725 51.298 227.701 51.398 227.701 51.506C227.701 51.65 227.745 51.77 227.833 51.866C227.921 51.962 228.037 52.046 228.181 52.118C228.325 52.186 228.489 52.248 228.673 52.304C228.857 52.36 229.045 52.42 229.237 52.484C229.429 52.548 229.617 52.622 229.801 52.706C229.985 52.79 230.149 52.894 230.293 53.018C230.437 53.138 230.553 53.286 230.641 53.462C230.729 53.634 230.773 53.844 230.773 54.092C230.773 54.38 230.721 54.646 230.617 54.89C230.513 55.134 230.361 55.346 230.161 55.526C229.961 55.706 229.711 55.846 229.411 55.946C229.115 56.046 228.775 56.096 228.391 56.096C228.179 56.096 227.973 56.076 227.773 56.036C227.577 56 227.389 55.95 227.209 55.886C227.033 55.818 226.867 55.738 226.711 55.646C226.559 55.554 226.423 55.454 226.303 55.346L226.603 54.854C226.639 54.794 226.683 54.748 226.735 54.716C226.791 54.68 226.859 54.662 226.939 54.662C227.023 54.662 227.105 54.69 227.185 54.746C227.269 54.798 227.365 54.856 227.473 54.92C227.585 54.984 227.719 55.044 227.875 55.1C228.031 55.152 228.225 55.178 228.457 55.178C228.649 55.178 228.815 55.156 228.955 55.112C229.095 55.064 229.211 55 229.303 54.92C229.395 54.84 229.463 54.75 229.507 54.65C229.551 54.546 229.573 54.436 229.573 54.32C229.573 54.164 229.529 54.036 229.441 53.936C229.353 53.836 229.235 53.75 229.087 53.678C228.943 53.606 228.777 53.542 228.589 53.486C228.405 53.43 228.217 53.37 228.025 53.306C227.833 53.242 227.643 53.168 227.455 53.084C227.271 53 227.105 52.894 226.957 52.766C226.813 52.634 226.697 52.476 226.609 52.292C226.521 52.104 226.477 51.876 226.477 51.608C226.477 51.364 226.525 51.132 226.621 50.912C226.721 50.692 226.865 50.498 227.053 50.33C227.245 50.162 227.479 50.03 227.755 49.934C228.035 49.834 228.357 49.784 228.721 49.784C229.133 49.784 229.507 49.85 229.843 49.982C230.179 50.114 230.461 50.294 230.689 50.522L230.401 50.99ZM237.145 49.88V56H236.365C236.193 56 236.083 55.918 236.035 55.754L235.939 55.184C235.811 55.32 235.675 55.444 235.531 55.556C235.391 55.668 235.241 55.764 235.081 55.844C234.921 55.924 234.749 55.986 234.565 56.03C234.385 56.074 234.191 56.096 233.983 56.096C233.647 56.096 233.351 56.04 233.095 55.928C232.839 55.816 232.623 55.658 232.447 55.454C232.275 55.25 232.145 55.006 232.057 54.722C231.969 54.434 231.925 54.118 231.925 53.774V49.88H233.215V53.774C233.215 54.186 233.309 54.506 233.497 54.734C233.689 54.962 233.979 55.076 234.367 55.076C234.651 55.076 234.915 55.012 235.159 54.884C235.407 54.752 235.639 54.572 235.855 54.344V49.88H237.145ZM238.712 56V49.88H239.492C239.668 49.88 239.78 49.962 239.828 50.126L239.912 50.66C240.024 50.532 240.14 50.416 240.26 50.312C240.38 50.204 240.508 50.112 240.644 50.036C240.784 49.956 240.932 49.894 241.088 49.85C241.248 49.806 241.42 49.784 241.604 49.784C241.8 49.784 241.98 49.812 242.144 49.868C242.308 49.924 242.452 50.004 242.576 50.108C242.704 50.212 242.814 50.338 242.906 50.486C242.998 50.634 243.074 50.8 243.134 50.984C243.226 50.772 243.342 50.59 243.482 50.438C243.622 50.286 243.778 50.162 243.95 50.066C244.122 49.97 244.304 49.9 244.496 49.856C244.692 49.808 244.89 49.784 245.09 49.784C245.418 49.784 245.71 49.836 245.966 49.94C246.226 50.044 246.444 50.196 246.62 50.396C246.8 50.592 246.936 50.834 247.028 51.122C247.12 51.41 247.166 51.738 247.166 52.106V56H245.876V52.106C245.876 51.674 245.782 51.35 245.594 51.134C245.41 50.914 245.136 50.804 244.772 50.804C244.608 50.804 244.454 50.832 244.31 50.888C244.166 50.944 244.04 51.026 243.932 51.134C243.824 51.242 243.738 51.378 243.674 51.542C243.614 51.702 243.584 51.89 243.584 52.106V56H242.294V52.106C242.294 51.658 242.204 51.33 242.024 51.122C241.844 50.91 241.58 50.804 241.232 50.804C240.992 50.804 240.77 50.866 240.566 50.99C240.362 51.11 240.174 51.276 240.002 51.488V56H238.712Z"
              fill="#4F4F4F"
            />
            <path
              d="M121 60.5C121 74.2524 116.315 87.5944 107.716 98.3272C99.1175 109.06 87.1189 116.543 73.6977 119.543C60.2765 122.543 46.2337 120.881 33.8837 114.831C21.5337 108.78 11.6134 98.7032 5.75797 86.2597C-0.097515 73.8161 -1.53881 59.749 1.67162 46.3766C4.88205 33.0042 12.5526 21.1246 23.4191 12.6956C34.2856 4.26669 47.6996 -0.208547 61.4503 0.00746358C75.201 0.223474 88.4678 5.11785 99.0641 13.8839L60.5 60.5H121Z"
              fill="#36A5DD"
            />
          </svg>
        </div>
      </v-card>
    </v-col> -->

    <v-col cols="12" xs="12" sm="12" md="6" lg="6" v-if="isAdmin">
      <StatisticsTopFive />
    </v-col>

    <v-col cols="12" xs="12" sm="12" md="6" lg="6" v-if="isAdmin">
      <v-card outlined rounded class="user-card pa-3">
        <v-row>
          <v-col cols="4" xs="12" sm="12" md="4" lg="4">
            <v-label>{{translate('From')}}-{{translate('To')}} {{ translate('date') }}:</v-label>
            <v-menu
              ref="menu"
              v-model="menu"
              :close-on-content-click="false"
              :return-value.sync="date"
              transition="scale-transition"
              offset-y
              min-width="auto"
            >
              <template v-slot:activator="{ on, attrs }">
                <v-text-field
                  v-model="formated_date"
                  append-icon="mdi-calendar"
                  readonly
                  regular
                  v-bind="attrs"
                  v-on="on"
                ></v-text-field>
              </template>
              <v-date-picker
                v-model="date"
                no-title
                scrollable
                range
              >
                <v-spacer></v-spacer>
                <v-btn
                  text
                  color="primary"
                  @click="menu = false"
                >
                  Cancel
                </v-btn>
                <v-btn
                  text
                  color="primary"
                  @click="$refs.menu.save(date)"
                >
                  OK
                </v-btn>
              </v-date-picker>
            </v-menu>
          </v-col>
          <v-col cols="4" xs="12" sm="12" md="4" lg="4">
            <v-label>{{ translate("Agent") }}:</v-label>
                <v-select
                    :items="get_agents_list"
                    :label="translate('Agent')"
                ></v-select>
          </v-col>

          <v-col cols="4" xs="12" sm="12" md="4" lg="4" class="d-flex align-center justify-end">
            <v-btn color="primary" class="mt-4">{{translate("Download")}}</v-btn>
          </v-col>
        </v-row>
      </v-card>
    </v-col>
    <v-row justify="space-between">
      <v-col cols="12" xs="12" sm="12" md="4" lg="4">
        <v-text-field
          v-model="search"
          rounded
          filled
          background-color="white"
          :label="translate('Search')"
          prepend-inner-icon="mdi-magnify"
        ></v-text-field>
      </v-col>
      <v-col cols="12" xs='12' md="4" lg="4">
        <div class="d-flex justify-end align-center">
          <v-select
            v-model="active_filter"
            :items="filters"
            :value="filters[0]"
          >
          </v-select>
        </div>
      </v-col>
    </v-row>
    <v-col cols="12" md="12" lg="12">
      <v-data-table
        :headers="headers"
        :items="data"
        :search="search"
        :loading="loading"
        :options.sync="options"
        :server-items-length="totalTableData"
        :footer-props="{'items-per-page-text':translate('Rows per page'), 'items-per-page-all-text':translate('All')}"
      >
        <template v-slot:loading>
          {{translate('Loading items')}}...
        </template>
        <template v-slot:no-data>
          {{translate('No data available')}}
        </template>
        <template v-slot:[`item.agent_name`]="{ item }">
          <div v-if="item.user != null">
            {{ item.user.first_name }} {{ item.user.last_name }}
          </div>
        </template>

        <template v-slot:[`item.edit_commission`]="{ item }">
          <v-btn v-if="item.rated != null" icon @click="openEditModal(item, false)">
            <svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5.4821 8.94807L5.00602 12.298C4.98108 12.4757 5.03437 12.6553 5.15222 12.7902C5.26992 12.9251 5.44034 13.0017 5.61888 13H5.6944L9.08546 12.5772V12.577C9.22097 12.5599 9.34679 12.4977 9.44298 12.4006L16.1473 5.65393C16.6788 5.1571 16.9865 4.46458 16.9996 3.73522C17.0127 3.0059 16.7301 2.30261 16.2167 1.7869C15.7035 1.27119 15.0035 0.987279 14.2777 1.00044C13.5519 1.01361 12.8626 1.32273 12.3681 1.85661L5.65536 8.59929C5.56146 8.69364 5.50047 8.81606 5.48181 8.94821L5.4821 8.94807ZM6.66691 9.32578L13.2304 2.72678C13.6031 2.40349 14.1136 2.29252 14.5858 2.43212C15.0582 2.57172 15.4275 2.94285 15.5665 3.41747C15.7054 3.89194 15.595 4.40493 15.2732 4.77934L8.71808 11.3783L6.33218 11.674L6.66691 9.32578Z" fill="#36a5dd"/>
              <path d="M9.53572 0H2.35709C1.73198 0 1.13243 0.244597 0.690427 0.680187C0.248267 1.11564 0 1.70629 0 2.32228V16.6777C0 17.2937 0.248279 17.8844 0.690427 18.3198C1.13243 18.7554 1.73198 19 2.35709 19H15.6429C16.268 19 16.8676 18.7554 17.3096 18.3198C17.7517 17.8844 18 17.2937 18 16.6777V8.07501C18 7.84882 17.8774 7.63971 17.6786 7.52662C17.4797 7.41338 17.2347 7.41338 17.0357 7.52662C16.8368 7.63971 16.7144 7.84882 16.7144 8.07501V16.6777C16.7144 16.9577 16.6014 17.2263 16.4005 17.4242C16.1996 17.6221 15.9271 17.7333 15.6429 17.7333H2.35709C2.07294 17.7333 1.80044 17.6221 1.59955 17.4242C1.39865 17.2263 1.28565 16.9577 1.28565 16.6777V2.32228C1.28565 2.04234 1.39865 1.77373 1.59955 1.57582C1.80044 1.3779 2.07293 1.26672 2.35709 1.26672H9.53572C9.76546 1.26672 9.97758 1.14597 10.0925 0.949974C10.2073 0.754121 10.2073 0.5126 10.0925 0.316608C9.97758 0.120755 9.76547 3.73898e-06 9.53572 3.73898e-06L9.53572 0Z" fill="#36a5dd"/>
            </svg>
          </v-btn>
          <v-btn v-else icon @click="openEditModal(item, true)">
            <svg width="20" height="20" viewBox="0 0 26 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23.2854 3.54275L11.1711 14.5999L6.77125 9.79979C6.34276 9.3426 5.62849 9.3141 5.14257 9.71409C4.68538 10.1426 4.65688 10.8568 5.05687 11.3428L10.2283 16.9999C10.4569 17.257 10.7712 17.3714 11.0855 17.3714C11.3713 17.3714 11.6284 17.2857 11.857 17.0856L24.8284 5.22846C25.2856 4.79997 25.3141 4.08571 24.9141 3.59979C24.4856 3.1426 23.7713 3.1141 23.2856 3.54259L23.2854 3.54275Z" fill="#FFC107"></path><path d="M11.9999 24C18.6285 24 23.9999 18.6286 23.9999 12C23.9999 11.4286 23.9714 10.8857 23.8857 10.3428C23.8 9.71428 23.2286 9.28576 22.6001 9.37147C21.9715 9.45717 21.543 10.0286 21.6287 10.6571C21.6859 11.1143 21.7144 11.5715 21.7144 12C21.7144 17.3428 17.343 21.7143 12.0001 21.7143C6.65724 21.7143 2.28581 17.3428 2.28581 12C2.28581 6.65713 6.65724 2.2857 12.0001 2.2857C14.2859 2.2857 16.5144 3.0857 18.2572 4.57147C18.7429 4.97146 19.4572 4.91427 19.8572 4.42857C20.2572 3.94288 20.2 3.22857 19.7143 2.82862C17.5716 0.999847 14.8287 0 12 0C5.37143 0 0 5.37143 0 12C0 18.6286 5.37143 24 12 24L11.9999 24Z" fill="#FFC107"></path></svg>
          </v-btn>
          </template>

        <template v-slot:[`item.commission`]="{ item }">
          <span v-if="item.rated != null">
            {{ parseInt(item.commission) }}
          </span>
          <span v-else>
            {{ translate('Pending') }}
          </span>
        </template>

        <template v-slot:[`item.customer_name`]="{ item }">
          <div v-if="item.customer">
            {{ item.customer.first_name }} {{ item.customer.last_name }}
          </div>
        </template>

        <template v-slot:[`item.created_at`]="{item}">
          {{ item | moment("DD.MM.YYYY HH:mm") }}
        </template>
      </v-data-table>

          <v-dialog v-model="dialog" max-width="500px">
            <v-card>
              <v-card-title class="d-flex justify-center">
                <span class="text-h5">Set the default fee % for all agents</span>
              </v-card-title>

              <v-card-text>
                <v-container>
                  <v-row class="d-flex justify-center">
                    <v-col cols="12" xs="12" md="4" lg="4">
                      <v-text-field small outlined type="number" v-model="percentage" max="100" min="0" value="0">
                      </v-text-field>
                    </v-col>
                  </v-row>
                </v-container>
              </v-card-text>

              <v-card-actions>
                <v-spacer></v-spacer>
                <v-btn
                  v-show="isCreateMode"
                  color="primary"
                  @click="save"
                >
                  Done
                </v-btn>
                <v-btn
                  v-show="!isCreateMode"
                  color="primary"
                  @click="update"
                >
                  Done
                </v-btn>
              </v-card-actions>
            </v-card>
          </v-dialog>

      <template v-slot:top>
        <v-toolbar flat>
          <v-spacer></v-spacer>
          <v-dialog v-model="dialogDelete" max-width="550px">
              <v-card>
              <v-row no-gutters no-wrap style="padding: 24px;">
                  <img src="@/assets/gifs/trash.gif" style="width: 56px; height: 56px;" />
                  <div style="margin-left: 16px;">
                      <v-card-title class="text-h5 p-0">{{translate('Delete')}}</v-card-title>
                      <v-card-text class="p-0" style="margin-top: 4px;">{{ translate('Are you sure you want to delete this item?') }}</v-card-text>
                  </div>
              </v-row>
              <v-card-actions class="justify-end">
                  <button @click="closeDelete" class="btn btn-cancel" :class="{ 'btn-dark': $vuetify.theme.dark }"
                      >{{ translate('Cancel') }}</button
                  >
                  <button
                      color="blue darken-1"
                      text
                      @click="deleteItemModalConfirm()"
                      class="btn btn-decline"
                      >{{translate('Confirm')}}</button
                  >
              </v-card-actions>
              </v-card>
          </v-dialog>
        </v-toolbar>
      </template>
    </v-col>
  </v-row>
</template>

<script>
import axios from "axios";
import Vue from "vue";
import * as LANGUAGE from '../../store/language.json';
import SnackBar from "../Snackbar/SnackBar.vue";
import StatisticsTopFive from "../Statistics/StatisticsTopFive.vue";

Vue.use(require('vue-moment'));

export default {
  data() {
    return {
      date: (new Date(Date.now() - (new Date()).getTimezoneOffset() * 60000)).toISOString().substr(0, 10),
      menu: false,
      search: "",
      isAdmin: false,
      percentage: 0,

      filters: [
        {
          text: this.translate('All'),
          value: 'All'
        },
        {
          text: this.translate('Approved'),
          value: 'Approved'
        },
        {
          text: this.translate('Pending'),
          value: 'Pending'
        }
      ],

      headers: [
        {
          text: this.translate("Date"),
          align: "start",
          value: "created_at",
        },
        { text: this.translate('Agent Name'), value: 'agent_name' },
        { text: this.translate('Customer Name'), value: 'customer_name' },
        { text: this.translate("Insurance package"), value: "insurance" },
        { text: this.translate("Commissions"), value: "commission" },
        { text: this.translate('Actions'), value: 'edit_commission', align: 'center' }
      ],
      data: [],

      get_agents_list: [],

      snackbar: {
        show: false,
        message: null,
        color: null,
      },

      isCreateMode: true,

      dialog: false,
      dialogDelete: false,

      loading: true,
      options: {},
      totalTableData: 0,

      active_filter: 'All',
      editItemInfo: 0,
      editModal: false,
      commission_value: 0,
    };
  },

  computed: {
    formated_date(){
        if (!this.date) return null

        const [year, month, day] = this.date.split('-')
        return `${day}.${month}.${year}`
    },
  },

  watch: {
    options: {
      handler() {
        this.getItemsTable();
      },
      deep: true,
    },

    active_filter(new_filter_value){
      this.getItemsTable(new_filter_value);
    }
  },

  components: {
    SnackBar,
    StatisticsTopFive
  },

  methods: {
    translate(word) {
      let wordIndex = null;

      LANGUAGE.forEach((lng, index) => {
        if(lng.english.toLowerCase() == word.toLowerCase()) {
          wordIndex = index;
        }
      });

      if(wordIndex === null) {
        return word;
      }

      if(this.$store.state.language == 'german') {
        return LANGUAGE[wordIndex].german;
      } else {
        return LANGUAGE[wordIndex].english;
      }
    },
    async updateCommission(){
      this.loading = true;
      this.editModal = false;

      axios
        .put(`billing/commission/${this.editItemInfo.id}`, {
          commission: this.commission_value,
          customer_id: this.editItemInfo.customer_id,
          user_id: this.editItemInfo.user_id
        })
        .then(response => {
          
          this.snackbar = {
            show: true,
            message: response.data.message,
            color: 'success',
            error: response.data.message.toLowerCase() == "commission value invalid" ? true : false
          };

          this.$refs.snackbar.toggleSnackbar(true);

          this.getItemsTable();
        }).catch(err => console.log(err));
    },

    openEditModal(item, firstTime){
      this.editItemInfo = item;
      this.commission_value = firstTime ? 0 : parseInt(item.commission);
      this.editModal = true;
    },

    getItemsTable(active_filter = 'All') {
      this.loading = true;
      const { sortBy, sortDesc, page, itemsPerPage } = this.options;

      let sortType;
      sortType = "asc";
      if (sortDesc[0]) {
        sortType = "desc";
      }

      axios
        .get("/billing/datatable", {
          params: {
            sort_by: sortBy[0],
            sort: sortType,
            page: page,
            per_page: itemsPerPage,
            filter: active_filter
          },
        })
        .then((response) => {
          console.log(response.data.data);
          this.data = response.data.data;
          this.totalTableData = response.data.total;
          this.loading = false;

          this.$nextTick(() => {
            const currentEl = this.$el.querySelector(".v-data-footer__pagination");
            const translated = currentEl.innerHTML.replace("of", this.translate("of"));

            currentEl.innerHTML = translated;
          });
        })
        .catch((error) => {
          console.log(error);
        });
        
    },

    getAgentsList() {
      axios
          .get("/admin/agent")
          .then((response) => {

            for (let $i = 0; response.data.length > 0; $i++) {

              this.get_agents_list.push({
                text: response.data[$i].first_name + ' ' + response.data[$i].last_name,
                value: response.data[$i].id,
              });

            }

          })
          .catch((error) => {
            console.log(error);
          });
    },

    
  openDialog() {
      this.isCreateMode = true;
      this.dialog = true;
    },
  },

  save(){
    this.dialog = false;
  },

  update(){
    this.dialog = false;
  },


  mounted() {
    this.getItemsTable();
    this.getAgentsList();

    if (this.$helperPlugin.ifAdmin()) {
      this.isAdmin = true;
    }
  },
};
</script>

<style scoped>
.v-data-table {
  border-radius: 10px;
}

.user-card {
  border-radius: 10px !important;
  border: none;
}

.v-data-table tr td {
  border: none !important;
}

.card-title .text-h4 {
  font-size: 20px !important;
  line-height: 24px !important;
}

.percent {
  color: #fe9210;
  font-weight: 500;
  font-size: 12px;
}

.name {
  color: #686868;
  font-weight: 500;
  font-size: 12px;
}
</style>